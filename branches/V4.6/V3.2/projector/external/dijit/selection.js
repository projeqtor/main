//>>built
define("dijit/selection",["dojo/dom","dojo/_base/lang","dojo/sniff","dojo/_base/window"],function(_1,_2,_3,_4){var _5=function(_6){var _7=_6.document;this.getType=function(){if(_7.getSelection){var _8="text";var _9;try{_9=_6.getSelection();}catch(e){}if(_9&&_9.rangeCount==1){var _a=_9.getRangeAt(0);if((_a.startContainer==_a.endContainer)&&((_a.endOffset-_a.startOffset)==1)&&(_a.startContainer.nodeType!=3)){_8="control";}}return _8;}else{return _7.selection.type.toLowerCase();}};this.getSelectedText=function(){if(_7.getSelection){var _b=_6.getSelection();return _b?_b.toString():"";}else{if(this.getType()=="control"){return null;}return _7.selection.createRange().text;}};this.getSelectedHtml=function(){if(_7.getSelection){var _c=_6.getSelection();if(_c&&_c.rangeCount){var i;var _d="";for(i=0;i<_c.rangeCount;i++){var _e=_c.getRangeAt(i).cloneContents();var _f=_7.createElement("div");_f.appendChild(_e);_d+=_f.innerHTML;}return _d;}return null;}else{if(this.getType()=="control"){return null;}return _7.selection.createRange().htmlText;}};this.getSelectedElement=function(){if(this.getType()=="control"){if(_7.getSelection){var _10=_6.getSelection();return _10.anchorNode.childNodes[_10.anchorOffset];}else{var _11=_7.selection.createRange();if(_11&&_11.item){return _7.selection.createRange().item(0);}}}return null;};this.getParentElement=function(){if(this.getType()=="control"){var p=this.getSelectedElement();if(p){return p.parentNode;}}else{if(_7.getSelection){var _12=_7.getSelection();if(_12){var _13=_12.anchorNode;while(_13&&(_13.nodeType!=1)){_13=_13.parentNode;}return _13;}}else{var r=_7.selection.createRange();r.collapse(true);return r.parentElement();}}return null;};this.hasAncestorElement=function(_14){return this.getAncestorElement.apply(this,arguments)!=null;};this.getAncestorElement=function(_15){var _16=this.getSelectedElement()||this.getParentElement();return this.getParentOfType(_16,arguments);};function _17(_18,_19){if(_18&&_18.tagName){var _1a=_18.tagName.toLowerCase();for(var i=0;i<_19.length;i++){var _1b=String(_19[i]).toLowerCase();if(_1a==_1b){return _1b;}}}return "";};this.getParentOfType=function(_1c,_1d){while(_1c){if(_17(_1c,_1d).length){return _1c;}_1c=_1c.parentNode;}return null;};this.collapse=function(_1e){if(_7.getSelection){var _1f=_6.getSelection();if(_1f.removeAllRanges){if(_1e){_1f.collapseToStart();}else{_1f.collapseToEnd();}}else{_1f.collapse(_1e);}}else{var _20=_7.selection.createRange();_20.collapse(_1e);_20.select();}};this.remove=function(){var sel=_7.selection;if(_7.getSelection){sel=_6.getSelection();sel.deleteFromDocument();return sel;}else{if(sel.type.toLowerCase()!="none"){sel.clear();}return sel;}};this.selectElementChildren=function(_21,_22){var _23;_21=_1.byId(_21);if(_7.getSelection){var _24=_6.getSelection();if(_3("opera")){if(_24.rangeCount){_23=_24.getRangeAt(0);}else{_23=_7.createRange();}_23.setStart(_21,0);_23.setEnd(_21,(_21.nodeType==3)?_21.length:_21.childNodes.length);_24.addRange(_23);}else{_24.selectAllChildren(_21);}}else{_23=_21.ownerDocument.body.createTextRange();_23.moveToElementText(_21);if(!_22){try{_23.select();}catch(e){}}}};this.selectElement=function(_25,_26){var _27;_25=_1.byId(_25);if(_7.getSelection){var _28=_7.getSelection();_27=_7.createRange();if(_28.removeAllRanges){if(_3("opera")){if(_28.getRangeAt(0)){_27=_28.getRangeAt(0);}}_27.selectNode(_25);_28.removeAllRanges();_28.addRange(_27);}}else{try{var tg=_25.tagName?_25.tagName.toLowerCase():"";if(tg==="img"||tg==="table"){_27=_4.body(_7).createControlRange();}else{_27=_4.body(_7).createRange();}_27.addElement(_25);if(!_26){_27.select();}}catch(e){this.selectElementChildren(_25,_26);}}};this.inSelection=function(_29){if(_29){var _2a;var _2b;if(_7.getSelection){var sel=_6.getSelection();if(sel&&sel.rangeCount>0){_2b=sel.getRangeAt(0);}if(_2b&&_2b.compareBoundaryPoints&&_7.createRange){try{_2a=_7.createRange();_2a.setStart(_29,0);if(_2b.compareBoundaryPoints(_2b.START_TO_END,_2a)===1){return true;}}catch(e){}}}else{_2b=_7.selection.createRange();try{_2a=_29.ownerDocument.body.createControlRange();if(_2a){_2a.addElement(_29);}}catch(e1){try{_2a=_29.ownerDocument.body.createTextRange();_2a.moveToElementText(_29);}catch(e2){}}if(_2b&&_2a){if(_2b.compareEndPoints("EndToStart",_2a)===1){return true;}}}}return false;};};var _2c=new _5(window);_2c.SelectionManager=_5;return _2c;});